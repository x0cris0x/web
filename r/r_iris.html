<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Dataset Iris</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1688d9e1630bd0bcb1ec498477fd8fb7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Página principal</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html#r"> 
<span class="menu-text">R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html#python"> 
<span class="menu-text">Python</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html#power-bi"> 
<span class="menu-text">Power BI</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html#aplicaciones-web"> 
<span class="menu-text">Aplicaciones Web</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html#aplicaciones-moviles"> 
<span class="menu-text">Aplicaciones móviles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../index.html#tableau"> 
<span class="menu-text">Tableau</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cv_cristian_heredia.pdf"> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenido</h2>
   
  <ul>
  <li><a href="#analisis-del-dataset-de-iris" id="toc-analisis-del-dataset-de-iris" class="nav-link active" data-scroll-target="#analisis-del-dataset-de-iris"><strong>Analisis del dataset de iris</strong></a>
  <ul class="collapse">
  <li><a href="#cargar-las-librerias-y-el-dataset" id="toc-cargar-las-librerias-y-el-dataset" class="nav-link" data-scroll-target="#cargar-las-librerias-y-el-dataset">Cargar las librerias y el dataset</a></li>
  <li><a href="#modelado" id="toc-modelado" class="nav-link" data-scroll-target="#modelado">Modelado</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Dataset Iris</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="analisis-del-dataset-de-iris" class="level1">
<h1><strong>Analisis del dataset de iris</strong></h1>
<p>El dataset de iris (de Fisher o Anderson) proporciona las medidas en centímetros de la longitud y el ancho del sépalo y del pétalo, respectivamente, para 50 flores de cada una de las 3 especies de iris. Las especies son Iris setosa, versicolor y virginica.</p>
<section id="cargar-las-librerias-y-el-dataset" class="level2">
<h2 class="anchored" data-anchor-id="cargar-las-librerias-y-el-dataset">Cargar las librerias y el dataset</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cargar el dataset dentro de la variable datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>datos  <span class="ot">=</span> iris </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Información del dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datos) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150   5</code></pre>
</div>
</div>
<p>Tiene 150 observaciones con 5 variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(datos) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   150 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<p>Se observa que 4 variables son numericas, excepto Species que es categoria, es la variable a analizar</p>
<p><br> Resumen estadístico, la variable Species tiene 3 categorias distribuidas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.350   Median :1.300  
 Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
       Species  
 setosa    :50  
 versicolor:50  
 virginica :50  
                
                
                </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>datos,<span class="fu">aes</span>(<span class="at">x=</span>Sepal.Width, <span class="at">y=</span>Sepal.Length,<span class="at">color=</span>Species)) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Gráfico entre Sepal Lenght y Sepal Width distribuido por Specie"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="r_iris_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>datos, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Width)) <span class="sc">+</span>  </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.2</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="fu">aes</span>(<span class="at">fill=</span>Species)) <span class="sc">+</span>  </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sepal Width"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Histograma de Sepal Width"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="r_iris_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> Petal.Width, <span class="at">fill =</span> Species), <span class="at">alpha=</span><span class="fl">0.25</span>) <span class="sc">+</span>  </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Densidad distribuida de Petal Width"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="r_iris_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>datos,<span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y=</span>Sepal.Length,<span class="at">color=</span>Species)) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span>  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Boxplot de Sepal.Length por Specie"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="r_iris_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Correlación y distribucíon de las variables numericas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(datos[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="r_iris_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Existe una correlación alta entre Petal Length y Petal Width</p>
</section>
<section id="modelado" class="level2">
<h2 class="anchored" data-anchor-id="modelado">Modelado</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(datos<span class="sc">$</span>Species, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> datos[train, ] </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>testData  <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train, ] </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se divide el dataset en 80% train y 20% test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>preProcValues <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(trainData[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>)) </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>trainTransformed <span class="ot">&lt;-</span> <span class="fu">predict</span>(preProcValues, trainData[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>testTransformed  <span class="ot">&lt;-</span> <span class="fu">predict</span>(preProcValues, testData[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se realiza un escalado y centrado de variables y disminuir la varianza de las variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>trainTransformed<span class="sc">$</span>Species <span class="ot">&lt;-</span> trainData<span class="sc">$</span>Species </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>testTransformed<span class="sc">$</span>Species  <span class="ot">&lt;-</span> testData<span class="sc">$</span>Species </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Reconstruimos los datasets con la variable objetivo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Realizamos un cross-validation para evitar el sobreajuste</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rf"</span>, <span class="st">"svmRadial"</span>, <span class="st">"knn"</span>, <span class="st">"gbm"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Los modelos que se van a entrenar son: random forest, svmRadial, k-Nearest Neighbour y Generalized Boosted Models</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">lapply</span>(methods, <span class="cf">function</span>(m) { </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">train</span>(Species <span class="sc">~</span> ., </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> trainTransformed, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> m, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">trControl =</span> ctrl, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">tuneLength =</span> <span class="dv">3</span>)}) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.2819
     2        0.9045            -nan     0.1000    0.1944
     3        0.7669            -nan     0.1000    0.1632
     4        0.6454            -nan     0.1000    0.1294
     5        0.5552            -nan     0.1000    0.1057
     6        0.4845            -nan     0.1000    0.0901
     7        0.4219            -nan     0.1000    0.0661
     8        0.3726            -nan     0.1000    0.0632
     9        0.3267            -nan     0.1000    0.0397
    10        0.2921            -nan     0.1000    0.0385
    20        0.1212            -nan     0.1000    0.0049
    40        0.0558            -nan     0.1000   -0.0062
    60        0.0373            -nan     0.1000   -0.0114
    80        0.0266            -nan     0.1000   -0.0015
   100        0.0186            -nan     0.1000   -0.0014
   120        0.0160            -nan     0.1000   -0.0022
   140        0.0085            -nan     0.1000    0.0005
   150        0.0064            -nan     0.1000   -0.0013

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.3863
     2        0.8479            -nan     0.1000    0.2362
     3        0.6854            -nan     0.1000    0.1921
     4        0.5556            -nan     0.1000    0.1408
     5        0.4567            -nan     0.1000    0.1102
     6        0.3867            -nan     0.1000    0.0913
     7        0.3235            -nan     0.1000    0.0673
     8        0.2771            -nan     0.1000    0.0543
     9        0.2393            -nan     0.1000    0.0418
    10        0.2094            -nan     0.1000    0.0311
    20        0.0811            -nan     0.1000   -0.0043
    40        0.0329            -nan     0.1000   -0.0074
    60        0.0191            -nan     0.1000   -0.0014
    80        0.0084            -nan     0.1000   -0.0016
   100        0.0066            -nan     0.1000   -0.0005
   120        0.0048            -nan     0.1000   -0.0007
   140        0.0031            -nan     0.1000   -0.0008
   150        0.0036            -nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.3371
     2        0.8577            -nan     0.1000    0.1736
     3        0.7203            -nan     0.1000    0.2120
     4        0.5793            -nan     0.1000    0.1490
     5        0.4778            -nan     0.1000    0.1021
     6        0.3977            -nan     0.1000    0.0621
     7        0.3488            -nan     0.1000    0.0844
     8        0.2931            -nan     0.1000    0.0555
     9        0.2512            -nan     0.1000    0.0439
    10        0.2225            -nan     0.1000    0.0396
    20        0.0773            -nan     0.1000   -0.0027
    40        0.0321            -nan     0.1000   -0.0053
    60        0.0189            -nan     0.1000   -0.0056
    80        0.0102            -nan     0.1000   -0.0010
   100        0.0079            -nan     0.1000    0.0000
   120        0.0043            -nan     0.1000   -0.0012
   140        0.0035            -nan     0.1000   -0.0002
   150        0.0025            -nan     0.1000   -0.0006

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.2701
     2        0.9007            -nan     0.1000    0.2149
     3        0.7505            -nan     0.1000    0.1610
     4        0.6336            -nan     0.1000    0.1372
     5        0.5398            -nan     0.1000    0.1046
     6        0.4675            -nan     0.1000    0.0900
     7        0.4039            -nan     0.1000    0.0710
     8        0.3524            -nan     0.1000    0.0595
     9        0.3107            -nan     0.1000    0.0553
    10        0.2742            -nan     0.1000    0.0337
    20        0.0976            -nan     0.1000    0.0092
    40        0.0328            -nan     0.1000   -0.0002
    60        0.0180            -nan     0.1000   -0.0013
    80        0.0153            -nan     0.1000    0.0031
   100        0.0086            -nan     0.1000   -0.0000
   120        0.0070            -nan     0.1000   -0.0010
   140        0.0045            -nan     0.1000    0.0005
   150        0.0046            -nan     0.1000   -0.0020

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.3049
     2        0.8981            -nan     0.1000    0.2934
     3        0.7084            -nan     0.1000    0.2216
     4        0.5594            -nan     0.1000    0.1525
     5        0.4532            -nan     0.1000    0.1278
     6        0.3724            -nan     0.1000    0.0720
     7        0.3218            -nan     0.1000    0.0679
     8        0.2701            -nan     0.1000    0.0478
     9        0.2289            -nan     0.1000    0.0530
    10        0.1943            -nan     0.1000    0.0361
    20        0.0550            -nan     0.1000    0.0024
    40        0.0233            -nan     0.1000   -0.0075
    60        0.0075            -nan     0.1000   -0.0014
    80        0.0048            -nan     0.1000   -0.0020
   100        0.0043            -nan     0.1000   -0.0009
   120        0.0023            -nan     0.1000   -0.0005
   140        0.0044            -nan     0.1000   -0.0024
   150        0.0017            -nan     0.1000   -0.0001

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.4043
     2        0.8441            -nan     0.1000    0.2732
     3        0.6682            -nan     0.1000    0.1758
     4        0.5397            -nan     0.1000    0.1437
     5        0.4396            -nan     0.1000    0.1234
     6        0.3603            -nan     0.1000    0.0891
     7        0.3000            -nan     0.1000    0.0704
     8        0.2547            -nan     0.1000    0.0438
     9        0.2206            -nan     0.1000    0.0451
    10        0.1872            -nan     0.1000    0.0315
    20        0.0557            -nan     0.1000   -0.0028
    40        0.0196            -nan     0.1000   -0.0027
    60        0.0102            -nan     0.1000    0.0015
    80        0.0034            -nan     0.1000   -0.0008
   100        0.0026            -nan     0.1000   -0.0012
   120        0.0055            -nan     0.1000   -0.0002
   140        0.0024            -nan     0.1000   -0.0010
   150        0.0030            -nan     0.1000   -0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.2917
     2        0.9100            -nan     0.1000    0.1953
     3        0.7653            -nan     0.1000    0.1660
     4        0.6527            -nan     0.1000    0.1216
     5        0.5571            -nan     0.1000    0.1084
     6        0.4836            -nan     0.1000    0.0834
     7        0.4234            -nan     0.1000    0.0769
     8        0.3652            -nan     0.1000    0.0650
     9        0.3202            -nan     0.1000    0.0535
    10        0.2816            -nan     0.1000    0.0418
    20        0.1045            -nan     0.1000    0.0056
    40        0.0307            -nan     0.1000   -0.0009
    60        0.0132            -nan     0.1000   -0.0018
    80        0.0078            -nan     0.1000   -0.0016
   100        0.0044            -nan     0.1000   -0.0009
   120        0.0028            -nan     0.1000   -0.0009
   140        0.0019            -nan     0.1000   -0.0004
   150        0.0016            -nan     0.1000    0.0000

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.3907
     2        0.8429            -nan     0.1000    0.2709
     3        0.6693            -nan     0.1000    0.1874
     4        0.5460            -nan     0.1000    0.1490
     5        0.4461            -nan     0.1000    0.1171
     6        0.3694            -nan     0.1000    0.0817
     7        0.3084            -nan     0.1000    0.0653
     8        0.2621            -nan     0.1000    0.0368
     9        0.2313            -nan     0.1000    0.0388
    10        0.1973            -nan     0.1000    0.0255
    20        0.0658            -nan     0.1000    0.0018
    40        0.0211            -nan     0.1000   -0.0051
    60        0.0100            -nan     0.1000   -0.0006
    80        0.0054            -nan     0.1000   -0.0018
   100        0.0036            -nan     0.1000   -0.0008
   120        0.0018            -nan     0.1000   -0.0005
   140        0.0009            -nan     0.1000   -0.0003
   150        0.0010            -nan     0.1000   -0.0003

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.3792
     2        0.8543            -nan     0.1000    0.2861
     3        0.6755            -nan     0.1000    0.1860
     4        0.5480            -nan     0.1000    0.1077
     5        0.4683            -nan     0.1000    0.1293
     6        0.3789            -nan     0.1000    0.0698
     7        0.3247            -nan     0.1000    0.0659
     8        0.2790            -nan     0.1000    0.0639
     9        0.2383            -nan     0.1000    0.0533
    10        0.2045            -nan     0.1000    0.0416
    20        0.0669            -nan     0.1000   -0.0062
    40        0.0216            -nan     0.1000   -0.0048
    60        0.0086            -nan     0.1000   -0.0019
    80        0.0038            -nan     0.1000   -0.0003
   100        0.0017            -nan     0.1000   -0.0001
   120        0.0009            -nan     0.1000   -0.0002
   140        0.0005            -nan     0.1000   -0.0001
   150        0.0004            -nan     0.1000   -0.0000

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.2919
     2        0.8982            -nan     0.1000    0.2070
     3        0.7486            -nan     0.1000    0.1778
     4        0.6277            -nan     0.1000    0.1337
     5        0.5346            -nan     0.1000    0.1108
     6        0.4559            -nan     0.1000    0.0926
     7        0.3932            -nan     0.1000    0.0744
     8        0.3404            -nan     0.1000    0.0649
     9        0.2955            -nan     0.1000    0.0502
    10        0.2597            -nan     0.1000    0.0472
    20        0.0808            -nan     0.1000    0.0123
    40        0.0156            -nan     0.1000   -0.0007
    60        0.0049            -nan     0.1000    0.0006
    80        0.0024            -nan     0.1000   -0.0003
   100        0.0011            -nan     0.1000    0.0001
   120        0.0005            -nan     0.1000   -0.0000
   140        0.0003            -nan     0.1000    0.0000
   150        0.0002            -nan     0.1000   -0.0000

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.3109
     2        0.8801            -nan     0.1000    0.2917
     3        0.6836            -nan     0.1000    0.2120
     4        0.5433            -nan     0.1000    0.1511
     5        0.4410            -nan     0.1000    0.1141
     6        0.3607            -nan     0.1000    0.0905
     7        0.2962            -nan     0.1000    0.0702
     8        0.2474            -nan     0.1000    0.0549
     9        0.2052            -nan     0.1000    0.0470
    10        0.1716            -nan     0.1000    0.0363
    20        0.0415            -nan     0.1000    0.0017
    40        0.0066            -nan     0.1000   -0.0009
    60        0.0021            -nan     0.1000    0.0001
    80        0.0007            -nan     0.1000   -0.0001
   100        0.0003            -nan     0.1000   -0.0001
   120        0.0001            -nan     0.1000   -0.0000
   140        0.0001            -nan     0.1000   -0.0000
   150        0.0000            -nan     0.1000   -0.0000

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.2641
     2        0.8942            -nan     0.1000    0.3135
     3        0.6976            -nan     0.1000    0.2142
     4        0.5509            -nan     0.1000    0.1557
     5        0.4433            -nan     0.1000    0.0825
     6        0.3806            -nan     0.1000    0.0998
     7        0.3146            -nan     0.1000    0.0726
     8        0.2580            -nan     0.1000    0.0509
     9        0.2166            -nan     0.1000    0.0535
    10        0.1823            -nan     0.1000    0.0367
    20        0.0489            -nan     0.1000    0.0098
    40        0.0116            -nan     0.1000   -0.0042
    60        0.0042            -nan     0.1000   -0.0010
    80        0.0032            -nan     0.1000   -0.0008
   100        0.0028            -nan     0.1000   -0.0008
   120        0.0033            -nan     0.1000   -0.0004
   140        0.0017            -nan     0.1000   -0.0003
   150        0.0012            -nan     0.1000   -0.0002

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.2878
     2        0.8979            -nan     0.1000    0.1986
     3        0.7505            -nan     0.1000    0.1575
     4        0.6372            -nan     0.1000    0.1219
     5        0.5550            -nan     0.1000    0.1002
     6        0.4768            -nan     0.1000    0.0664
     7        0.4121            -nan     0.1000    0.0741
     8        0.3580            -nan     0.1000    0.0597
     9        0.3184            -nan     0.1000    0.0558
    10        0.2828            -nan     0.1000    0.0432
    20        0.1116            -nan     0.1000    0.0054
    40        0.0461            -nan     0.1000    0.0008
    60        0.0251            -nan     0.1000   -0.0032
    80        0.0149            -nan     0.1000   -0.0024
   100        0.0128            -nan     0.1000   -0.0026
   120        0.0083            -nan     0.1000   -0.0013
   140        0.0042            -nan     0.1000   -0.0008
   150        0.0039            -nan     0.1000   -0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.3846
     2        0.8554            -nan     0.1000    0.1914
     3        0.7160            -nan     0.1000    0.1477
     4        0.6091            -nan     0.1000    0.1698
     5        0.4930            -nan     0.1000    0.1181
     6        0.4099            -nan     0.1000    0.0950
     7        0.3465            -nan     0.1000    0.0677
     8        0.2943            -nan     0.1000    0.0635
     9        0.2529            -nan     0.1000    0.0274
    10        0.2230            -nan     0.1000    0.0386
    20        0.0896            -nan     0.1000    0.0082
    40        0.0243            -nan     0.1000    0.0006
    60        0.0136            -nan     0.1000   -0.0024
    80        0.0087            -nan     0.1000   -0.0011
   100        0.0026            -nan     0.1000   -0.0003
   120        0.0010            -nan     0.1000   -0.0000
   140        0.0006            -nan     0.1000   -0.0002
   150        0.0004            -nan     0.1000   -0.0001

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.3655
     2        0.8520            -nan     0.1000    0.2548
     3        0.6852            -nan     0.1000    0.1707
     4        0.5612            -nan     0.1000    0.1614
     5        0.4562            -nan     0.1000    0.1134
     6        0.3832            -nan     0.1000    0.0902
     7        0.3180            -nan     0.1000    0.0710
     8        0.2674            -nan     0.1000    0.0469
     9        0.2270            -nan     0.1000    0.0413
    10        0.1963            -nan     0.1000    0.0367
    20        0.0756            -nan     0.1000   -0.0011
    40        0.0280            -nan     0.1000   -0.0029
    60        0.0095            -nan     0.1000   -0.0006
    80        0.0054            -nan     0.1000   -0.0019
   100        0.0031            -nan     0.1000    0.0000
   120        0.0013            -nan     0.1000   -0.0001
   140        0.0009            -nan     0.1000   -0.0003
   150        0.0008            -nan     0.1000    0.0000

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.0986            -nan     0.1000    0.2649
     2        0.9022            -nan     0.1000    0.2098
     3        0.7622            -nan     0.1000    0.1729
     4        0.6382            -nan     0.1000    0.1301
     5        0.5465            -nan     0.1000    0.1152
     6        0.4721            -nan     0.1000    0.0764
     7        0.4132            -nan     0.1000    0.0736
     8        0.3606            -nan     0.1000    0.0652
     9        0.3179            -nan     0.1000    0.0495
    10        0.2815            -nan     0.1000    0.0376
    20        0.1116            -nan     0.1000    0.0081
    40        0.0484            -nan     0.1000   -0.0014
    50        0.0319            -nan     0.1000   -0.0016</code></pre>
</div>
</div>
<p>Se entreno el modelo, con los 4 modelos mas utilizados</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(models) <span class="ot">&lt;-</span> methods</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">resamples</span>(models)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.resamples(object = results)

Models: rf, svmRadial, knn, gbm 
Number of resamples: 5 

Accuracy 
               Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
rf        0.9583333 0.9583333 0.9583333 0.9750000 1.0000000 1.0000000    0
svmRadial 0.9166667 0.9583333 0.9583333 0.9500000 0.9583333 0.9583333    0
knn       0.8750000 0.9583333 0.9583333 0.9583333 1.0000000 1.0000000    0
gbm       0.9166667 0.9583333 0.9583333 0.9583333 0.9583333 1.0000000    0

Kappa 
            Min. 1st Qu. Median   Mean 3rd Qu.   Max. NA's
rf        0.9375  0.9375 0.9375 0.9625  1.0000 1.0000    0
svmRadial 0.8750  0.9375 0.9375 0.9250  0.9375 0.9375    0
knn       0.8125  0.9375 0.9375 0.9375  1.0000 1.0000    0
gbm       0.8750  0.9375 0.9375 0.9375  0.9375 1.0000    0</code></pre>
</div>
</div>
<p>Resumen estadístico del Accuracy y Kappa de cada modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(results)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="r_iris_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como se observa en la gráfica, rf tiene mayor Accuracy y Kappa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> models[[<span class="st">"rf"</span>]]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_model, <span class="at">newdata =</span> testTransformed)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions, testTransformed<span class="sc">$</span>Species)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         10          0         0
  versicolor      0         10         2
  virginica       0          0         8

Overall Statistics
                                          
               Accuracy : 0.9333          
                 95% CI : (0.7793, 0.9918)
    No Information Rate : 0.3333          
    P-Value [Acc &gt; NIR] : 8.747e-12       
                                          
                  Kappa : 0.9             
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                 1.0000            1.0000           0.8000
Specificity                 1.0000            0.9000           1.0000
Pos Pred Value              1.0000            0.8333           1.0000
Neg Pred Value              1.0000            1.0000           0.9091
Prevalence                  0.3333            0.3333           0.3333
Detection Rate              0.3333            0.3333           0.2667
Detection Prevalence        0.3333            0.4000           0.2667
Balanced Accuracy           1.0000            0.9500           0.9000</code></pre>
</div>
</div>
<p>En los datos de prueba, se obtuvo excelentes resultados a la hora de clasificar las diferentes Species. Con un 93.3% de Accuracy y 90% de Kappa</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>importance <span class="ot">&lt;-</span> <span class="fu">varImp</span>(best_model, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(importance)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="r_iris_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Las variables mas importantes son Petal Width y Petal Length</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>